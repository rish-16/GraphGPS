import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import matplotlib 
from pprint import pprint

font = {'family' : 'normal',
        'size'   : 10}

matplotlib.rc('font', **font)

"""
S-default
VS-Heads
VS-Dims
VS-Layers
"""

data2plot = [
    [
        [0.0008363723754882812, 7.033348083496094e-05, 6.961822509765625e-05, 6.365776062011719e-05, 7.200241088867188e-05], [0.0010521411895751953, 6.771087646484375e-05, 6.29425048828125e-05, 9.846687316894531e-05, 0.0002689361572265625], [0.00010585784912109375, 8.487701416015625e-05, 7.748603820800781e-05, 8.797645568847656e-05, 8.511543273925781e-05]
    ],
    [[6.604194641113281e-05, 6.890296936035156e-05, 6.580352783203125e-05, 6.175041198730469e-05, 6.437301635742188e-05], [7.462501525878906e-05, 0.00011134147644042969, 6.794929504394531e-05, 6.151199340820312e-05, 6.961822509765625e-05], [9.34600830078125e-05, 0.00010561943054199219, 8.988380432128906e-05, 7.557868957519531e-05, 8.273124694824219e-05]],
    [[5.841255187988281e-05, 5.4836273193359375e-05, 6.67572021484375e-05, 6.270408630371094e-05, 5.364418029785156e-05], [7.295608520507812e-05, 8.153915405273438e-05, 6.413459777832031e-05, 6.031990051269531e-05, 6.4849853515625e-05], [6.866455078125e-05, 6.413459777832031e-05, 5.9604644775390625e-05, 6.222724914550781e-05, 5.745887756347656e-05]],
    [[8.869171142578125e-05, 6.270408630371094e-05, 6.127357482910156e-05, 6.508827209472656e-05, 6.29425048828125e-05], [8.988380432128906e-05,  6.914138793945312e-05, 8.511543273925781e-05, 6.651878356933594e-05, 7.557868957519531e-05], [8.225440979003906e-05, 7.200241088867188e-05, 8.606910705566406e-05, 7.033348083496094e-05, 9.417533874511719e-05]]
]

for i in range(len(data2plot)):
    temps = []
    for j in range(len(data2plot[i])):
        tmp = sum(data2plot[i][j]) / len(data2plot[i][j])
        temps.append(tmp)

    data2plot[i] = temps

data2plot[0].insert(0, "S-Default")
data2plot[1].insert(0, "VS-Heads")
data2plot[2].insert(0, "VS-Dims")
data2plot[3].insert(0, "VS-Layers")

df = pd.DataFrame(data2plot, columns=["Model", "Dot", "Softmax", "Project"])

df.plot(x='Model',
        kind='bar',
        stacked=True,
        title='Attention | B=256 | Layer 1 | GINE+MHSA | RWSE')
plt.xticks(rotation = 45)
plt.show()