import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import matplotlib 

font = {'family' : 'normal',
        'size'   : 13}

matplotlib.rc('font', **font)

# seconds
SINGLE_BATCH_256_TRAIN_TIME_SMALL = 1.0084445476531982
SINGLE_BATCH_256_TRAIN_TIME_VSMALL_HEADS = 1.0015337467193604
SINGLE_BATCH_256_TRAIN_TIME_VSMALL_DIMS = 1.004216194152832
SINGLE_BATCH_256_TRAIN_TIME_VSMALL_LAYERS = 1.0355498790740967
SINGLE_BATCH_256_TRAIN_TIME_VSMALL_BS = None # doesn't exist

SINGLE_BATCH_256_TRAIN_TIME_VVSMALL_HEADS = 0.9982786178588867
SINGLE_BATCH_256_TRAIN_TIME_VVSMALL_DIMS = 0.9732253551483154
SINGLE_BATCH_256_TRAIN_TIME_VVSMALL_LAYERS = 0.9351785182952881
SINGLE_BATCH_256_TRAIN_TIME_VVSMALL_BS = None # doesn't exist

# # heads, dims, layers
# df = pd.DataFrame([
#     ["S", 0, 0, 1.00844454765319820],
#     ["V-S", 1.0015337467193604, 1.004216194152832, 1.0355498790740967],
#     ["VV-S", 0.9982786178588867, 0.9732253551483154, 0.9351785182952881]
# ], columns=["Model", "# Heads", "Embed Dims", "# Layers"])

# df.plot(x='Model',
#         # y='Wall clock time (seconds)',
#         kind='bar',
#         stacked=False,
#         title='Wall clock timings B=256')        
# plt.xticks(rotation = 45)
# plt.show()

# --------------------------------------------------------------------

"""
DEFAULT SMALL
***LOCAL MESSAGE PASSING TIME: 0.006574392318725586
***TIME FOR GLOBAL MP: 0.004009723663330078
***LOCAL MESSAGE PASSING TIME: 0.002140522003173828
***TIME FOR GLOBAL MP: 0.0014035701751708984
***LOCAL MESSAGE PASSING TIME: 0.0018091201782226562
***TIME FOR GLOBAL MP: 0.0013108253479003906
***LOCAL MESSAGE PASSING TIME: 0.0018603801727294922
***TIME FOR GLOBAL MP: 0.0013709068298339844
***LOCAL MESSAGE PASSING TIME: 0.0021233558654785156
***TIME FOR GLOBAL MP: 0.0013146400451660156
"""

"""
VSMALL-HEADS
***LOCAL MESSAGE PASSING TIME: 0.002469778060913086
***TIME FOR GLOBAL MP: 0.001718282699584961
***LOCAL MESSAGE PASSING TIME: 0.001939535140991211
***TIME FOR GLOBAL MP: 0.0013890266418457031
***LOCAL MESSAGE PASSING TIME: 0.0016720294952392578
***TIME FOR GLOBAL MP: 0.0013582706451416016
***LOCAL MESSAGE PASSING TIME: 0.0016193389892578125
***TIME FOR GLOBAL MP: 0.0013918876647949219
***LOCAL MESSAGE PASSING TIME: 0.0018353462219238281
***TIME FOR GLOBAL MP: 0.0013759136199951172
"""

"""
VSMALL-DIMS
***LOCAL MESSAGE PASSING TIME: 0.0019409656524658203
***TIME FOR GLOBAL MP: 0.0012433528900146484
***LOCAL MESSAGE PASSING TIME: 0.0012507438659667969
***TIME FOR GLOBAL MP: 0.0009102821350097656
***LOCAL MESSAGE PASSING TIME: 0.0013573169708251953
***TIME FOR GLOBAL MP: 0.0011572837829589844
***LOCAL MESSAGE PASSING TIME: 0.0012180805206298828
***TIME FOR GLOBAL MP: 0.0008742809295654297
***LOCAL MESSAGE PASSING TIME: 0.001337289810180664
***TIME FOR GLOBAL MP: 0.0009407997131347656
"""

"""
VSMALL-LAYERS
***LOCAL MESSAGE PASSING TIME: 0.0025093555450439453
***TIME FOR GLOBAL MP: 0.0015192031860351562
***LOCAL MESSAGE PASSING TIME: 0.0015668869018554688
***TIME FOR GLOBAL MP: 0.0011320114135742188
***LOCAL MESSAGE PASSING TIME: 0.0017757415771484375
***TIME FOR GLOBAL MP: 0.0010657310485839844
"""

"""
VVSMALL-HEADS
***LOCAL MESSAGE PASSING TIME: 0.0025796890258789062
***TIME FOR GLOBAL MP: 0.001486063003540039
***LOCAL MESSAGE PASSING TIME: 0.0018987655639648438
***TIME FOR GLOBAL MP: 0.0013988018035888672
***LOCAL MESSAGE PASSING TIME: 0.001589059829711914
***TIME FOR GLOBAL MP: 0.0011355876922607422
***LOCAL MESSAGE PASSING TIME: 0.0016620159149169922
***TIME FOR GLOBAL MP: 0.0013828277587890625
***LOCAL MESSAGE PASSING TIME: 0.0018913745880126953
***TIME FOR GLOBAL MP: 0.0012438297271728516
"""

"""
VVSMALL-DIMS
***LOCAL MESSAGE PASSING TIME: 0.001840353012084961
***TIME FOR GLOBAL MP: 0.001302480697631836
***LOCAL MESSAGE PASSING TIME: 0.0011196136474609375
***TIME FOR GLOBAL MP: 0.0008313655853271484
***LOCAL MESSAGE PASSING TIME: 0.0011119842529296875
***TIME FOR GLOBAL MP: 0.0006880760192871094
***LOCAL MESSAGE PASSING TIME: 0.0012025833129882812
***TIME FOR GLOBAL MP: 0.0009164810180664062
***LOCAL MESSAGE PASSING TIME: 0.0010628700256347656
***TIME FOR GLOBAL MP: 0.0010035037994384766
"""

"""
VVSMALL-LAYERS
***LOCAL MESSAGE PASSING TIME: 0.002499818801879883
***TIME FOR GLOBAL MP: 0.0015349388122558594
"""

# # heads, dims, layers
# df = pd.DataFrame([
#     ["S", 0.006574392318725586, 0.004009723663330078],
#     ["VS-Heads", 0.002469778060913086, 0.001718282699584961],
#     ["VS-Dims", 0.0019409656524658203, 0.0012433528900146484],
#     ["VS-Layers", 0.0025093555450439453, 0.0015192031860351562],
#     ["VVS-Heads", 0.0025796890258789062, 0.001486063003540039],
#     ["VVS-Dims", 0.001840353012084961, 0.001302480697631836],
#     ["VVS-Layers", 0.002499818801879883, 0.0015349388122558594]
# ], columns=["Model", "Local", "Global"])

# df.plot(x='Model',
#         kind='bar',
#         stacked=False,
#         title='Wall clock timings B=256 | Layer=1')
# plt.xticks(rotation = 45)
# plt.show()

# --------------------------------------------------------------------


"""
DEFAULT SMALL
***LOCAL MESSAGE PASSING TIME: 0.006574392318725586
***TIME FOR GLOBAL MP: 0.004009723663330078
***LOCAL MESSAGE PASSING TIME: 0.002140522003173828
***TIME FOR GLOBAL MP: 0.0014035701751708984
***LOCAL MESSAGE PASSING TIME: 0.0018091201782226562
***TIME FOR GLOBAL MP: 0.0013108253479003906
***LOCAL MESSAGE PASSING TIME: 0.0018603801727294922
***TIME FOR GLOBAL MP: 0.0013709068298339844
***LOCAL MESSAGE PASSING TIME: 0.0021233558654785156
***TIME FOR GLOBAL MP: 0.0013146400451660156
"""

"""
VSMALL-HEADS
***LOCAL MESSAGE PASSING TIME: 0.002469778060913086
***TIME FOR GLOBAL MP: 0.001718282699584961
***LOCAL MESSAGE PASSING TIME: 0.001939535140991211
***TIME FOR GLOBAL MP: 0.0013890266418457031
***LOCAL MESSAGE PASSING TIME: 0.0016720294952392578
***TIME FOR GLOBAL MP: 0.0013582706451416016
***LOCAL MESSAGE PASSING TIME: 0.0016193389892578125
***TIME FOR GLOBAL MP: 0.0013918876647949219
***LOCAL MESSAGE PASSING TIME: 0.0018353462219238281
***TIME FOR GLOBAL MP: 0.0013759136199951172
"""

"""
VSMALL-DIMS
***LOCAL MESSAGE PASSING TIME: 0.0019409656524658203
***TIME FOR GLOBAL MP: 0.0012433528900146484
***LOCAL MESSAGE PASSING TIME: 0.0012507438659667969
***TIME FOR GLOBAL MP: 0.0009102821350097656
***LOCAL MESSAGE PASSING TIME: 0.0013573169708251953
***TIME FOR GLOBAL MP: 0.0011572837829589844
***LOCAL MESSAGE PASSING TIME: 0.0012180805206298828
***TIME FOR GLOBAL MP: 0.0008742809295654297
***LOCAL MESSAGE PASSING TIME: 0.001337289810180664
***TIME FOR GLOBAL MP: 0.0009407997131347656
"""

"""
VSMALL-LAYERS
***LOCAL MESSAGE PASSING TIME: 0.0025093555450439453
***TIME FOR GLOBAL MP: 0.0015192031860351562
***LOCAL MESSAGE PASSING TIME: 0.0015668869018554688
***TIME FOR GLOBAL MP: 0.0011320114135742188
***LOCAL MESSAGE PASSING TIME: 0.0017757415771484375
***TIME FOR GLOBAL MP: 0.0010657310485839844
"""

"""
VVSMALL-HEADS
***LOCAL MESSAGE PASSING TIME: 0.0025796890258789062
***TIME FOR GLOBAL MP: 0.001486063003540039
***LOCAL MESSAGE PASSING TIME: 0.0018987655639648438
***TIME FOR GLOBAL MP: 0.0013988018035888672
***LOCAL MESSAGE PASSING TIME: 0.001589059829711914
***TIME FOR GLOBAL MP: 0.0011355876922607422
***LOCAL MESSAGE PASSING TIME: 0.0016620159149169922
***TIME FOR GLOBAL MP: 0.0013828277587890625
***LOCAL MESSAGE PASSING TIME: 0.0018913745880126953
***TIME FOR GLOBAL MP: 0.0012438297271728516
"""

"""
VVSMALL-DIMS
***LOCAL MESSAGE PASSING TIME: 0.001840353012084961
***TIME FOR GLOBAL MP: 0.001302480697631836
***LOCAL MESSAGE PASSING TIME: 0.0011196136474609375
***TIME FOR GLOBAL MP: 0.0008313655853271484
***LOCAL MESSAGE PASSING TIME: 0.0011119842529296875
***TIME FOR GLOBAL MP: 0.0006880760192871094
***LOCAL MESSAGE PASSING TIME: 0.0012025833129882812
***TIME FOR GLOBAL MP: 0.0009164810180664062
***LOCAL MESSAGE PASSING TIME: 0.0010628700256347656
***TIME FOR GLOBAL MP: 0.0010035037994384766
"""

"""
VVSMALL-LAYERS
***LOCAL MESSAGE PASSING TIME: 0.002499818801879883
***TIME FOR GLOBAL MP: 0.0015349388122558594
"""

# heads, dims, layers
df = pd.DataFrame([
    ["S-L1", 0.006574392318725586, 0.004009723663330078],
    ["S-L2", 0.002140522003173828, 0.0014035701751708984],
    ["S-L3", 0.0018091201782226562, 0.0013108253479003906],
    ["S-L4", 0.0018603801727294922, 0.0013709068298339844],
    ["S-L5", 0.0021233558654785156, 0.0013146400451660156],
    ["VS-Hds-L1", 0.002469778060913086, 0.001718282699584961],
    ["VS-Hds-L2", 0.001939535140991211, 0.0013890266418457031],
    ["VS-Hds-L3", 0.0016720294952392578, 0.0013582706451416016],
    ["VS-Hds-L4", 0.0016193389892578125, 0.0013918876647949219],
    ["VS-Hds-L5", 0.0018353462219238281, 0.0013759136199951172],
    ["VVS-Hds-L1", 0.0025796890258789062, 0.001486063003540039],
    ["VVS-Hds-L2", 0.0018987655639648438, 0.0013988018035888672],
    ["VVS-Hds-L3", 0.001589059829711914, 0.0011355876922607422],
    ["VVS-Hds-L4", 0.0016620159149169922, 0.0013828277587890625],
    ["VVS-Hds-L5", 0.0018913745880126953, 0.0012438297271728516]
], columns=["Model", "Local", "Global"])

df.plot(x='Model',
        kind='bar',
        stacked=True,
        title='Layer-wise clock timings B=256')
plt.xticks(rotation = 45)
plt.show()

# --------------------------------------------------------------------

SINGLE_BATCH_256_LMP_INFERENCE_TIME_SMALL = None
SINGLE_BATCH_256_LMP_INFERENCE_TIME_VSMALL_HEADS = None
SINGLE_BATCH_256_LMP_INFERENCE_TIME_VSMALL_DIMS = None
SINGLE_BATCH_256_LMP_INFERENCE_TIME_VSMALL_LAYERS = None
SINGLE_BATCH_256_LMP_INFERENCE_TIME_VSMALL_BS = None

SINGLE_BATCH_256_GMP_INFERENCE_TIME_SMALL = None
SINGLE_BATCH_256_GMP_INFERENCE_TIME_VSMALL_HEADS = None
SINGLE_BATCH_256_GMP_INFERENCE_TIME_VSMALL_DIMS = None
SINGLE_BATCH_256_GMP_INFERENCE_TIME_VSMALL_LAYERS = None
SINGLE_BATCH_256_GMP_INFERENCE_TIME_VSMALL_BS = None

SINGLE_BATCH_256_ATTENTION_DOTPRODUCT_STEP_TIME_SMALL = None
SINGLE_BATCH_256_ATTENTION_DOTPRODUCT_STEP_TIME_VSMALL_HEADS = None
SINGLE_BATCH_256_ATTENTION_DOTPRODUCT_STEP_TIME_VSMALL_DIMS = None
SINGLE_BATCH_256_ATTENTION_DOTPRODUCT_STEP_TIME_VSMALL_LAYERS = None
SINGLE_BATCH_256_ATTENTION_DOTPRODUCT_STEP_TIME_VSMALL_BS = None

SINGLE_BATCH_256_ATTENTION_PROJECTION_STEP_TIME_SMALL = None
SINGLE_BATCH_256_ATTENTION_PROJECTION_STEP_TIME_VSMALL_HEADS = None
SINGLE_BATCH_256_ATTENTION_PROJECTION_STEP_TIME_VSMALL_DIMS = None
SINGLE_BATCH_256_ATTENTION_PROJECTION_STEP_TIME_VSMALL_LAYERS = None
SINGLE_BATCH_256_ATTENTION_PROJECTION_STEP_TIME_VSMALL_BS = None